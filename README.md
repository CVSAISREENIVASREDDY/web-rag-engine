# Web-RAG Engine

A scalable Retrieval-Augmented Generation (RAG) platform that asynchronously ingests, indexes, and answers questions about web content. Built with FastAPI, Celery, Redis, ChromaDB, and Groq LLMs.

---

## System Architecture

![System Architecture](./architecture.png)

**How it works:**
1. **User submits a URL or query to the API.**
2. **Ingestion jobs are queued via Celery/Redis.**
3. **Background workers process URLs, fetch content, split and embed text, then store in ChromaDB.**
4. **Questions are semantically embedded, relevant content retrieved, and answers generated by Groq LLM.**
5. **PostgreSQL tracks the status of all jobs.**

---

## Components

| Component            | Technology         | Purpose                                   |
|----------------------|-------------------|-------------------------------------------|
| API Server           | FastAPI           | Accepts/validates requests                |
| Task Worker          | Celery + Redis    | Background ingestion, extraction, embedding|
| Metadata Store       | PostgreSQL        | Tracks job status                         |
| Vector DB            | ChromaDB          | Stores and searches text chunk embeddings |
| LLM                  | Groq API (llama3) | Generates fact-grounded answers           |
| Embedding Model      | all-MiniLM-L6-v2  | Fast, robust text embeddings              |
| Infrastructure       | Docker Compose    | Container orchestration                   |

---

## Database Schema

### ingestion_jobs (PostgreSQL)
```sql
CREATE TABLE ingestion_jobs (
    id UUID PRIMARY KEY,
    url VARCHAR NOT NULL UNIQUE,
    status VARCHAR NOT NULL DEFAULT 'PENDING',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

### ChromaDB Collection
- **Embedding Vector:** SentenceTransformer (MiniLM-L6-v2), 384 dimensions
- **Document:** Cleaned chunk of source text (max ~1000 chars)
- **Metadata:** `{"source_url": "<URL>"}`

---

## API Endpoints

### Ingest a URL

- `POST /ingest-url`
- Accepts: `{ "url": "https://..." }`
- Returns: `{ "job_id": "<uuid>", "status": "PENDING", ... }`

**Example:**
```bash
curl -X POST "http://localhost:8000/ingest-url" -H "Content-Type: application/json" -d '{"url": "https://en.wikipedia.org/wiki/Artificial_intelligence"}'
```

---

### Query Knowledge Base

- `POST /query`
- Accepts: `{ "query": "Your question..." }`
- Returns: `{ "answer": "...", "sources": [ ... ] }`

**Example:**
```bash
curl -X POST "http://localhost:8000/query" -H "Content-Type: application/json" -d '{"query": "What are some applications of LLMs?"}'
```

---

## Setup & Development

1. **Prerequisites:** Docker, git, Groq API key
2. **Clone & Configure:**
   ```bash
   git clone https://github.com/CVSAISREENIVASREDDY/web-rag-engine
   cd web-rag-engine
   cp .env.example .env
   # (Add your GROQ_API_KEY to .env)
   ```
3. **Start Services:**
   ```bash
   docker-compose up --build -d
   ```
4. **Access API Docs:**
   - http://localhost:8000/docs

5. **Stop Services:**
   ```bash
   docker-compose down
   ```

